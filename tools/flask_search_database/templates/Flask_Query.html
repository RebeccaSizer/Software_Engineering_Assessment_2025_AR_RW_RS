<!DOCTYPE html>
<html>
<head>
    <title>Query Database - {{ db_name }}</title>
    <style>
        body {
            background-color: #24bf96;
            color: white;
            font-family: "Nirmala UI", sans-serif;
            padding: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            background: white;
            color: black;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 5px;
        }
        input, select, button {
            font-family: "Nirmala UI", sans-serif;
            color: black;
            margin: 5px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <h1>Database: {{ db_name }}</h1>

    <form id="dbForm" method="POST" action="/switch_db">
        <label for="db_name"><strong>Select Database:</strong></label>
        <select name="db_name" id="db_name" onchange="this.form.submit()">
            {% for db in databases %}
            <option value="{{ db }}" {% if db == db_name %}selected{% endif %}>{{ db }}</option>
            {% endfor %}
        </select>
    </form>

    <hr>

    <form method="POST">
        <h3>Search by Patient ID</h3>
        <input list="patient_list" name="patient_ID" placeholder="Enter or select Patient ID" autocomplete="off">
        <datalist id="patient_list">
            {% for p in patient_list %}
            <option value="{{ p }}">
            {% endfor %}
        </datalist>

        <h3>Search by Variant</h3>
        <input list="variant_list" name="variant" placeholder="Enter or select Variant" autocomplete="off">
        <datalist id="variant_list">
            {% for v in variant_list %}
            <option value="{{ v }}">
            {% endfor %}
        </datalist>

        <h3>Search by Gene</h3>
       <input list="gene_list" name="gene" placeholder="Enter or select Gene" autocomplete="off">
        <datalist id="gene_list">
            {% for g in gene_list %}
            <option value="{{ g }}">
            {% endfor %}
        </datalist>

        <br><br>
        <button type="submit">Run Query</button>
    </form>

    <hr>

    {% if data %}
        {% if result_type == "patient" %}
            <h2>Variants for this Patient:</h2>
        {% elif result_type == "variant" %}
            <h2>Variant Details:</h2>
        {% elif result_type == "gene" %}
            <h2>Variants Associated with Same HGNC_ID:</h2>
        {% endif %}

        <table>
            <tr>
                {% for col in data[0].keys() %}
                <th>{{ col }}</th>
                {% endfor %}
            </tr>
            {% for row in data %}
            <tr>
                {% for col in row.keys() %}
                <td>{{ row[col] }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    {% endif %}
</body>
</html>